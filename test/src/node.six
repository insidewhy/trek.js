import {expect, p, parse, word} from "./helper"

describe("node parsing", () => {
  it("parses into a node with range information.", () => {
    var grammar = p.node("Friend", p.member("name", word)),
        ast     = parse(grammar, "totoro")

    expect(ast.name).to.equal("totoro")
    expect(ast.type).to.equal("Friend")
  })

  it("parses multiple layers of nodes.", () => {
    var wsNoNl = p.star(p.char("\r\t "))
    var Identifier = p.node("Identifier", p.member("name", word)),
        Variable   = p.node(
          "VariableDeclaration",
          "var",
          p.member("declarations",
                   p.joinPlusLex(p.lexeme(wsNoNl, ",", p.whitespace),
                                 Identifier))),
        grammar    = p.plus(Variable),
        ast        = parse(grammar, "var friend, \nkitten")

    expect(ast[0].declarations[1].name).to.equal("kitten")
  })
})
